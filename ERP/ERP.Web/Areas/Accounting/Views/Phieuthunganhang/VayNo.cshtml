
<script src="~/Content/self-writing/js/Controllers/NganhangCtrl/PhieuThuNganHang/ctrPhieuThuVayNo.js"></script>
<div class="container body-content" ng-app="myApp" ng-controller="ctrPhieuThuVayNo">
    <br>
    <br>
    <br>
    <div class="alert alert-info alert-dismissible" role="alert">

        <p>Ngân hàng</p>
    </div>
    <div class="table-kt">
        <div class="table-head bg-blue borderRadius3 clearfix">
            <h1 style="color:black;" class="table-head-title margin0 font16 borderRadius3 bg-white pull-left bold">Thu tiền gửi</h1>
        </div>
        <div class="border padding10 borderTopNone">
            <div class="row">
                <div class="col-md-8">
                    <form class="form-kt">
                        <fieldset>
                            <legend class="bold">Thông tin chung</legend>
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div>Đối tượng</div>
                                            </div>
                                            <div class="col-md-8">
                                                <div class="input-group">
                                                    <input type="text" ng-model="arrayTongHop.ma_doi_tuong" class="form-control" ng-change="onDoiTuongFind()" ng-focus="showtable_ma_doi_tuong = true" ng-blur="onBlurInput_MDT()">
                                                    <div class="input-group-btn">
                                                        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" ng-click="showtable_ma_doi_tuong = !showtable_ma_doi_tuong" ng-mouseenter="hoverbtn_MDT = true" ng-mouseleave="hoverbtn_MDT = false" aria-haspopup="true" aria-expanded="false">
                                                            <span class="caret"></span>
                                                        </button>
                                                        <div class="dropdown-menu dropdown-menu-center borderRadius0 padding0" style="display: block" ng-show="showtable_ma_doi_tuong">
                                                            <div class="table-responsive" style="max-height:298px;">
                                                                <table class="table table-striped table-condensed table-hover" st-table="dtCollection" st-safe-src="arrayDTFinded" ng-mouseenter="hovertable_MDT = true" ng-mouseleave="hovertable_MDT = false">
                                                                    <thead class="bg-blue text-white">
                                                                        <tr>
                                                                            <th>Mã đối tượng</th>
                                                                            <th>Tên đối tượng</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        <tr style="cursor:pointer" ng-click="showInfoDT(dt)" ng-repeat="dt in dtCollection">
                                                                            <td>{{dt.MA_DOI_TUONG}}</td>
                                                                            <td>{{dt.TEN_DOI_TUONG}}</td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <input type="text" ng-model="arrayTongHop.ten_doi_tuong" class="form-control">
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-md-2">
                                        <div>Địa chỉ</div>
                                    </div>
                                    <div class="col-md-10">
                                        <input type="text" ng-model="arrayTongHop.dia_chi" class="form-control">
                                    </div>
                                </div>
                            </div>


                            <div class="form-group">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div>Nộp vào TK</div>
                                            </div>
                                            <div class="col-md-8">
                                                <div class="input-group">
                                                    <input type="text" ng-model="arrayTongHop.so_tk_nop" class="form-control">
                                                    <div class="input-group-btn">
                                                        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                            <span class="caret"></span>
                                                        </button>
                                                        <div class="dropdown-menu dropdown-menu-center borderRadius0 padding0">
                                                            <div class="table-responsive">
                                                                <table class="table table-striped table-hover table-condensed" st-table="banksCollection" st-safe-src="arrayBanks">
                                                                    <thead class="bg-blue text-white">
                                                                        <tr>
                                                                            <th>Số tài khoản</th>
                                                                            <th>Tên ngân hàng</th>
                                                                            <th>Chi nhánh</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        <tr style="cursor:pointer" ng-click="showInfoTK(bank)" ng-repeat="bank in banksCollection">
                                                                            <td>{{bank.SO_TAI_KHOAN}}</td>
                                                                            <td>{{bank.TEN_NGAN_HANG}}</td>
                                                                            <td>{{bank.CHI_NHANH}}</td>
                                                                        </tr>

                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <input type="text" ng-model="arrayTongHop.ten_ngan_hang" class="form-control">
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div>Lý do thu</div>
                                            </div>
                                            <div class="col-md-8">
                                                <select ng-model="reasonmoney" ng-change="changeType($event)" class="form-control">
                                                    
                                                    <option value="VayNo">Vay nợ</option>
                                                    
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <input type="text" class="form-control" ng-model="arrayTongHop.dien_giai_ly_do_thu" placeholder="Vay tiền của ...">
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div>Nhân viên thu</div>
                                            </div>
                                            <div class="col-md-8">
                                                <div class="input-group">
                                                    <input type="text" class="form-control" ng-model="arrayTongHop.ho_va_ten" ng-change="onNhanVienFind()" ng-focus="showtable_ho_va_ten = true" >
                                                    <div class="input-group-btn">
                                                        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" ng-click="showtable_ho_va_ten = !showtable_ho_va_ten"  aria-haspopup="true" aria-expanded="false">
                                                            <span class="caret"></span>
                                                        </button>
                                                        <div class="dropdown-menu dropdown-menu-center borderRadius0 padding0" style="display: block" ng-show="showtable_ho_va_ten">
                                                            <div class="table-responsive" style="max-height: 280px">
                                                                <table class="table table-striped table-hover" st-pagination-scroll st-table="staffsCollection" st-safe-src="arrayNVFinded">
                                                                    <thead class="bg-blue text-white">
                                                                        <tr>
                                                                            <th>Mã nhân viên</th>
                                                                            <th>Tên nhân viên</th>
                                                                            <th>Phòng ban</th>
                                                                            <th>Điện thoại di động</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        <tr ng-repeat="staff in staffsCollection" style="cursor:pointer" ng-click="showInfoStaff(staff)">
                                                                            <td>{{staff.USERNAME}}</td>
                                                                            <td>{{staff.HO_VA_TEN}}</td>
                                                                            <td>{{staff.TEN_PHONG_BAN}}</td>
                                                                            <td>{{staff.SDT}}</td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row">
                                    <input type="hidden" value="@Session["USERNAME"]" id="sdfsdfsd"/>
                                    <button ng-click="test()">test</button>
                                    <div class="col-md-6">
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div>Tham chiếu</div>
                                            </div>
                                            <div class="col-md-8">
                                                <a href="">
                                                    <img src="~/Content/self-writing/Images/plus.png" alt="" ng-click="openModal()">
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                    </form>
                </div>
                <div class="col-md-4">
                    <form class="form-kt">
                        <fieldset>
                            <legend class="bold">Chứng từ</legend>
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-md-5">
                                        <div>Ngày hạch toán</div>
                                    </div>
                                    <div class="col-md-7">
                                        <input type="text" datepicker class="form-control datetimepickerKT" ng-model="arrayTongHop.ngay_hach_toan">
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-md-5">
                                        <div>Ngày chứng từ</div>
                                    </div>
                                    <div class="col-md-7">
                                        <input type="text" datepicker class="form-control datetimepickerKT" ng-model="arrayTongHop.ngay_chung_tu">
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-md-5">
                                        <div>Số chứng từ</div>
                                    </div>
                                    <div class="col-md-7">
                                        <input type="text" class="form-control" disabled="disabled">
                                    </div>
                                </div>
                            </div>
                            <br>
                            <br>
                            <br>
                            <br>
                            <br>
                            <br>
                            <br>
                        </fieldset>
                    </form>
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-md-7 col-md-offset-5">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="text-right">
                                <form class="form-inline">
                                    <div class="form-group">
                                        <label class="marginR15">Loại tiền</label>
                                        <select name="" class="form-control" ng-model="arraydiengiai[indexcurrent].loai_tien">
                                            <option value="USD">USD</option>
                                            <option value="VND">VND</option>
                                            <option value="EURO">EURO</option>
                                        </select>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="text-right">
                                <form class="form-inline">
                                    <div class="form-group">
                                        <label class="marginR15">Tỷ giá</label>
                                        <input type="text" class="form-control" ng-model="arraydiengiai[indexcurrent].ty_gia">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <br>

            <div class="table-responsive">
                <table class="table table-striped table-hover table-bordered" st-table="tonghopCollection" st-safe-src="arraydiengiai">
                    <thead class="bg-blue text-white">
                        <tr>
                            <th>Diễn giải</th>
                            <th>TK nợ</th>
                            <th>TK có</th>
                            <th>Số tiền</th>
                            <th ng-show="arraydiengiai[indexcurrent].loai_tien != 'VND'">Quy đổi</th>
                            <th>Đơn vị</th>
                            <th>Mã đối tượng</th>
                            <th>Tên đối tượng</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><a href="" ng-click="addTongHop()">Bấm vào đây để thêm mới</a></td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td ng-show="arraydiengiai[indexcurrent].loai_tien != 'VND'">&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                        </tr>
                        <tr ng-repeat="valueTongHop in tonghopCollection" ng-click="onChangeIndex($index)">
                            @*<td><div contenteditable="true">{{valueTongHop.diengiai}}</div></td>*@
                            <td><input type="text" class="form-control" style="max-width: 170px;" ng-model="arraydiengiai[$index].diengiai" ng-disabled="indexcurrent != $index"></td>
                            <td>
                                <div class="input-group maxWidth150">
                                    <input type="text" class="form-control" ng-model="arraydiengiai[$index].tk_no" ng-disabled="indexcurrent != $index">
                                    <div class="input-group-btn">
                                        <button type="button" class="btn btn-default dropdown-toggle height_hachtoan" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" ng-disabled="indexcurrent != $index">
                                            <span class="caret"></span>
                                        </button>
                                        <div class="dropdown-menu dropdown-menu-center borderRadius0 padding0">
                                            <div class="table-responsive" style="max-height:200px">
                                                <table class="table table-striped table-hover " st-pagination-scroll st-table="tknoCollections" st-safe-src="arrayBankHackToan">
                                                    <thead class="bg-blue text-white">
                                                        <tr>
                                                            <th>Số tài khoản</th>
                                                            <th>Tên Tài khoản</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr ng-repeat="valuetkno in tknoCollections" ng-click="showInfoTKNo(valuetkno)" style="cursor:pointer">
                                                            <td>{{valuetkno.SO_TK}}</td>
                                                            <td>{{valuetkno.TEN_TK}}</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </td>
                            <td>
                                <div class="input-group maxWidth150">
                                    <input type="text" class="form-control" ng-model="arraydiengiai[$index].tk_co" ng-disabled="indexcurrent != $index">
                                    <div class="input-group-btn">
                                        <button type="button" class="btn btn-default dropdown-toggle height_hachtoan" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" ng-disabled="indexcurrent != $index">
                                            <span class="caret"></span>
                                        </button>
                                        <div class="dropdown-menu dropdown-menu-center borderRadius0 padding0">
                                            <div class="table-responsive" style="max-height:200px">
                                                <table class="table table-striped table-hover " st-pagination-scroll st-table="tknoCollections" st-safe-src="arrayBankHackToan">
                                                    <thead class="bg-blue text-white">
                                                        <tr>
                                                            <th>Số tài khoản</th>
                                                            <th>Tên Tài khoản</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr ng-repeat="valuetkco in tknoCollections" ng-click="showInfoTKCo(valuetkco)" style="cursor:pointer">
                                                            <td>{{valuetkco.SO_TK}}</td>
                                                            <td>{{valuetkco.TEN_TK}}</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </td>
                            <td><input type="text" class="form-control maxWidth120" ng-model="valueTongHop.so_tien" ng-disabled="indexcurrent != $index"> </td>
                            <td ng-show="arraydiengiai[indexcurrent].loai_tien != 'VND'">{{valueTongHop.so_tien * valueTongHop.ty_gia}}</td>
                            <td>{{valueTongHop.loai_tien}}</td>
                            <td> {{arrayTongHop.ma_doi_tuong}}</td>
                            <td>{{arrayTongHop.ten_doi_tuong}}</td>
                        </tr>
                        <tr>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td ng-show="arraydiengiai[indexcurrent].loai_tien != 'VND'">&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                        </tr>
                        <tr>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td ng-show="arraydiengiai[indexcurrent].loai_tien != 'VND'">&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                        </tr>
                        <tr>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td ng-show="arraydiengiai[indexcurrent].loai_tien != 'VND'">&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                        </tr>
                        <tr>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td ng-show="arraydiengiai[indexcurrent].loai_tien != 'VND'">&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                        </tr>
                        <tr>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td ng-show="arraydiengiai[indexcurrent].loai_tien != 'VND'">&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <br>
            <div class="text-center">
                <button class="btn btn-primary" ng-click="onSave()"><span class="glyphicon glyphicon-floppy-disk"></span> Lưu</button>
                <button class="btn btn-danger" ng-click="onHuy()"><span class="glyphicon glyphicon-ban-circle"></span> Bỏ qua</button>
            </div>
        </div>
    </div>
    <br>
    <br>
    <br>


    <script type="text/ng-template" id="myModal.html">
        <div class="modal-body">
            <div class="table-kt">
                <div class="table-head bg-blue borderRadius3 clearfix">
                    <h1 class="table-head-title margin0 font16 text-white">Chọn chứng từ tham chiếu</h1>
                </div>
                <div class="border padding10 borderTopNone">
                    <br>
                    <div>
                        <div class="row">
                            <div class="col-md-5">
                                <form class="form-horizontal">
                                    <div class="form-group">
                                        <label for="inputEmail3" class="col-sm-3 control-label">Tìm theo</label>
                                        <div class="col-sm-9">
                                            <select class="form-control" ng-model="loaichungtu" ng-change="changeTypeThamChieu($event)">
                                                <option value="LoaiChungTu">Loại chứng từ</option>
                                                <option value="SoChungTu">Số chứng từ</option>
                                                <option value="SohoaDon">Số hóa đơn</option>
                                                <option value="DoiTuong">Đối tượng</option>
                                            </select>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="col-md-5">
                                <form class="form-horizontal" ng-show="showchungtu">
                                    <div class="form-group">
                                        <label for="inputEmail3" class="col-sm-3 control-label">Giá trị</label>
                                        <div class="col-sm-9">
                                            <select ng-model="valueselected_LoaiChungTu_CTTC" class="btn-group bootstrap-select form-control ClassSlect"
                                                    ng-options="option as option.name for option in valueLoaiChungTu" ng-change='optionGameValue()'>
                                                <!-- <option ng-repeat="option in data.listgame" value="{{option.id}}">{{option.name}}</option> -->
                                            </select>
                                        </div>
                                    </div>
                                </form>
                                <div class="input-group" ng-show="!showchungtu">
                                    <div class="row">
                                        <label for="inputEmail3" class="col-sm-2 control-label">Giá trị</label>
                                        <input type="text" ng-model="valueselected_CTTC.ma_doi_tuong" class="form-control col-sm-10" style="width:80%">
                                    </div>
                                    <div class="input-group-btn">
                                        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            <span class="caret"></span>
                                        </button>
                                        <div class="dropdown-menu dropdown-menu-center borderRadius0 padding0" style="left: -289px;">
                                            <div class="table-responsive">
                                                <table class="table table-striped table-condensed table-hover" st-table="dtCollectionThamChieu" st-safe-src="valueLoaiChungTu">
                                                    <thead class="bg-blue text-white">
                                                        <tr>
                                                            <th>Mã đối tượng</th>
                                                            <th>Tên đối tượng</th>
                                                            <th>Địa chỉ</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr style="cursor:pointer" ng-click="showSlected(dt)" ng-repeat="dt in dtCollectionThamChieu">
                                                            <td>{{dt.MA_DOI_TUONG}}</td>
                                                            <td>{{dt.TEN_DOI_TUONG}}</td>
                                                            <td>{{dt.DIA_CHI}}</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-5">
                            <form class="form-horizontal" style="display: none">
                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-3 control-label">Từ ngày</label>
                                    <div class="col-sm-9">
                                        <div class='input-group date datetimepickerKT'>
                                            <input type='text' class="form-control" />
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-calendar"></span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="col-md-5">
                            <form class="form-horizontal" style="display: none">
                                <div class="form-group">
                                    <label for="inputEmail3" class="col-sm-3 control-label">Đến ngày</label>
                                    <div class="col-sm-9">
                                        <div class='input-group date datetimepickerKT'>
                                            <input type='text' class="form-control" />
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-calendar"></span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="col-md-2">
                            <div class="text-right">
                                <button class="btn btn-primary" ng-click="getData()">Lấy dữ liệu</button>
                            </div>
                        </div>
                    </div>
                    <br>
                    <div class="text-center">

                    </div>
                    <div class="table-responsive">
                        <table class="table table-striped table-hover table-bordered" st-table="dtCollectionFinded" st-safe-src="dataFinded">
                            <thead class="bg-blue text-white">
                                <tr>
                                    @*<th>Ngày hạch toán</th>
                                        <th>Ngày chứng từ</th>
                                        <th>Số chứng từ</th>
                                        <th>Diễn giải</th>*@
                                    <th>Số chứng từ</th>
                                    <th>Tên chứng từ</th>
                                    <th>Mã công ty</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="valuefind in dtCollectionFinded">
                                    <td>
                                        <label class="checkbox-inline">
                                            <input type="checkbox" ng-checked="valuefind.selected" ng-click="changeChecked(valuefind)"> {{valuefind.ma_chung_tu}}
                                        </label>
                                    </td>
                                    <td>{{valuefind.TEN_CHUNG_TU}}</td>
                                    <td>{{valuefind.MA_CONG_TY}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <br>
                    <div class="text-center">
                        <button class="btn btn-primary" ng-click="ok()"><span class="glyphicon glyphicon-floppy-disk"></span> Đồng ý</button>
                        <button class="btn btn-danger" ng-click="cancel()"><span class="glyphicon glyphicon-ban-circle"></span> Bỏ qua</button>
                    </div>
                </div>
            </div>
        </div>
    </script>
</div>
<style>
    .bg-blue {
        background-color: #5BC0DE !important;
    }
</style>
